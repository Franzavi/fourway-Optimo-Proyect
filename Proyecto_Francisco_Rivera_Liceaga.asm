.data
        Memoria: .word 36, 51, 
146, 37, 
459, 75, 
234, 21, 
197, 07, 
170, 96, 
893, 00,
345, 66, 
519, 52, 
884, 92, 
343, 65, 
727, 56, 
170, 54, 
319, 41, 
655, 72, 
755, 40, 
1055519, 756955, 
1055220, 316282, 
1052669, 247183, 
1051017, 336491, 
1049942, 298940, 
1056598, 265598, 
1051432, 130958, 
1051389, 708233, 
1051113, 295095, 
1057830, 262423, 
1051276, 602894, 
1049591, 54429, 
1050716, 872556, 
1049590, 39163, 
1055013, 283201, 
1057732, 320322, 
1050035, 702043, 
1058099, 663303, 
1049800, 755082, 
1052666, 292385, 
1055911,1055850, 
1056187, 318474, 
1052553, 531342, 
1056560, 140262, 
1051049, 951414, 
1049187, 252218, 
1051659, 71116, 
1055736, 387562, 
1050377, 1048346, 
1050487, 224747, 
1053657, 304787, 
1053295, 534865, 
1049319, 668403, 
1056347, 416775, 
1053675, 720759, 
1055085, 137836, 
1054208, 74453, 
1054621, 48107, 
1054003, 587164, 
1058624, 944266, 
1056636, 620942, 
1056135, 563439, 
1051501, 682683, 
1049727, 431958, 
1058050, 277058, 
1055928, 645763, 
1057297, 670754, 
1054025, 804829, 
1058477, 247928, 
1052011, 306049, 
1049373, 24060, 
1054942, 308924, 
1055281, 375328, 
1055928, 688609, 
1053784, 644058, 
1053218, 801538, 
1050832, 937426, 
1053406, 949233, 
1056204, 82761, 
1058250, 557424, 
1051091, 47855, 
1052998, 844410, 
1049689, 333721, 
1056392, 249638, 
1052200, 283484, 
1053211, 150927, 
1050094, 205484, 
1057511, 883389, 
1053726, 789811, 
1057381, 788486, 
1049444, 281899, 
1052511, 120224, 
1055012, 51920, 
1048932, 292687, 
1057173, 696802, 
1051058, 664304, 
1051688, 608555, 
1057278, 212380, 
1049271, 433937, 
1056007, 301373, 
1056990, 884128, 
1055501, 802793, 
1051498, 917863, 
1055911, 441951, 
1054754, 787065, 
1053108, 74132, 
1051436, 1015962, 
1054031, 728423, 
1050846, 275633, 
1051133, 779764, 
1057221, 507336, 
1052660, 923658, 
1055040, 341906, 
1051431, 594685, 
1049882, 260602, 
1058441, 142558, 
1052854, 251869, 
1048968, 385494, 
1050296, 729374, 
1057557, 41361, 
1051258, 730059, 
1050466, 276467, 
1053344, 907985, 
1053723, 578882, 
1056438, 488129, 
1052939, 161826,
1055195, 271136, 
1057340, 415145, 
1050334, 1022483, 
1055921, 550590, 
1051295, 128137, 
1056016, 969789, 
1048901, 484004, 
1056300, 958964, 
1049944, 309415, 
1054400, 829121, 
1058592, 59262, 
1052259, 225827, 
1055330, 823137, 
1055121, 738619, 
1058377, 962356, 
1055250, 645416, 
1048906, 577231, 
1058089, 798305, 
1053513, 929895, 
1058600, 947401, 
1056438, 907182, 
1050995, 724239, 
1049820, 432072, 
1056583, 50727, 
1054912, 252734, 
1057783, 14797, 
1053933, 404602, 
1052382, 961551, 
1058032, 321812, 
1054720, 919370, 
1058437, 156004, 
1057163, 328508, 
1057036, 443339, 
1055145, 222787, 
1051934, 813503, 
1053938, 257099, 
1050133, 939310, 
1057817, 315396, 
1053347, 202119, 
1050121, 767567, 
1053229, 1014219, 
1050551, 955556, 
1053212, 742620, 
1049354, 862281, 
1056683, 918411, 
1057558, 941506, 
1056428, 244279, 
1056870, 664065, 
1049157, 258579, 
1052036, 469241, 
1056690, 829753, 
1058123, 758780, 
1056378, 259312, 
1054094, 782103, 
1053654, 962281, 
1057949, 892767, 
1058207, 1029755, 
1054644, 151432, 
1056687, 908327, 
1048635, 807775, 
1052925, 805878, 
1058249, 486984, 
1056094, 407130, 
1049951, 113875, 
1048922, 482801, 
1055854, 156082, 
1053475, 311208, 
1049074, 403243, 
1057197, 980020, 
1052393, 205076, 
1052567, 694354, 
1051355, 417883, 
1050775, 205096, 
1056718, 33640, 
1049234, 849932, 
1056185, 332125, 
1048622, 791759, 
1053730, 626073, 
1056478, 314215, 
1054895, 864434, 
1055435, 946064, 
1057385, 624958, 
1056530, 864100, 
1056945, 588436, 
1049118, 863449, 
1056612, 40656, 
1051296, 899395, 
1053432, 121356, 
1049306, 160245, 
1053866, 771717, 
1058432, 214093, 
1051843, 782289, 
1053521, 919202, 
1054487, 221582, 
1056041, 772486, 
1050263, 650098, 
1049239, 543751, 
1052584, 1016896, 
1053187, 195511, 
1055863, 212782, 
1055527, 698668, 
1052125, 783452, 
1051537, 396830, 
1056810, 1034645, 
1054477, 37324, 
1052405, 347942, 
1054056, 690017, 
1051047, 41712, 
1054915, 143760, 
1055607, 253064, 
1058318, 910922 
1050891, 969347, 
1056009, 8065, 
1051762, 260953, 
1050803, 646314, 
1049020, 1043585, 
1056764, 1038070, 
1049731, 656347, 
1054052, 1005218, 
1052932, 396187, 
1048598, 241220, 
1048818, 602275, 
1056388, 593687, 
1055622, 297969, 
1057477, 924532, 
1053062, 896375, 
1051470, 686858, 
1056849, 767089, 
1050971, 282745, 
1056720, 129311, 
1055945, 159904, 
1048644, 707981, 
1052203, 356744, 
1049660, 654747, 
1051951, 821846, 
1056852, 776913, 
1056586, 780461, 
1057983, 63495, 
1050475, 240674, 
1057929, 494257, 
1051652, 952896, 
1054417, 576896, 
1050207, 60566, 
1052447, 842163, 
1050732, 821341, 
1051490, 539563, 
1052018, 27297, 
1049796, 1034060, 
1048865, 256911, 
1052694, 955073, 
1058188, 475287, 
1056057, 66562, 
1054599, 105215, 
1058391, 390609, 
1056010, 544343, 
1053972, 402876, 
1058464, 1799, 
1052380, 760632, 
1055685, 365781, 
1058323, 695771, 
1048814, 179496, 
1057386, 658420, 
1058413, 450088, 
1057842, 717709, 
1055421, 189539, 
1054763, 940703, 
1052596, 169531, 
1053871, 103717, 
1056928, 807126, 
1048961, 947721, 
1058789, 262591, 
1049327, 633068, 
1054185, 81215, 
1054836, 282541, 
1048885, 897108, 
1056925, 725100, 
1056736, 516665, 
1058555, 378191, 
1049506, 226135, 
1049412, 242569, 
1049145, 810669, 
1056767, 419913, 
1058511, 872019, 
1058454, 556530, 
1056656, 108904, 
1052114, 51286, 
1058751, 995214, 
1056239, 651620, 
1055717, 1051412, 
1048839, 505385, 
1052407, 1041618, 
1055399, 606391, 
1055427, 246447, 
1058277, 124039, 
1053909, 138199, 
1053033, 786334, 
1055922, 146613, 
1052457, 198382, 
1048766, 420265, 
1056909, 356156, 
1054473, 486242, 
1058561, 109091, 
1055790, 180696, 
1056722, 679883, 
1057988, 834944, 
1054511, 394702, 
1056348, 324993, 
1058768, 951497, 
1056594, 767858, 
1049248, 431106, 
1053538, 197545, 
1053111, 54680, 
1056445, 1000602, 
1054995, 445858, 
1054513, 631913, 
1048702, 544357, 
1052128, 949578, 
1048682, 196983, 
1055699, 99112, 
1050160, 59950, 
1049983, 50495, 
1051579, 723683, 
1055889, 504036, 
1056608, 982635, 
1052537, 436045, 
1051165, 922207, 
1058755, 752601, 
1049002, 998909, 
1052610, 508982, 
1054793, 460688, 
1058065, 542797, 
1057501, 555960, 
1056319, 497195, 
1055649, 1016056, 
1050345, 907465, 
1057734, 323867, 
1054894, 763542, 
1051708, 905896, 
1051845, 326152, 
1057448, 166211, 
1058028, 81733, 
1051037, 792977, 
1049870, 566266, 
1058709, 481155, 
1055766, 839973, 
1049237, 231904, 
1054492, 324901, 
1050792, 775430, 
1052532, 487522, 
1058437, 429346, 
1052742, 266787, 
1051499, 616014, 
1054330, 856828, 
1049098, 53460, 
1049866, 157672, 
1054951, 520895, 
1049269, 945197, 
1052880, 331802, 
1048736, 299796, 
1050816, 68595, 
1055839, 64147, 
1051982, 613832, 
1053912, 887181, 
1058249, 368238, 
1050006, 369335, 
1049556, 44019, 
1051759, 414798, 
1052068, 918285, 
1057978, 26776, 
1048702, 181661, 
1055228, 880784, 
1056691, 13601, 
1056355, 494692, 
1051249, 881521, 
1051838, 954282, 
1052662, 537477, 
1054280, 889054, 
1056653, 601717, 
1056975, 820399, 
1054002, 331485, 
1054612, 114049, 
1054850, 736258, 
1052160, 786257, 
1057716, 420747, 
1050906, 367381, 
1057487, 57621, 
1048581, 397359, 
1053078, 388868, 
1058591, 301224, 
1057692, 969252, 
1056470, 699756, 
1049070, 451066, 
1053536, 662607, 
1050968, 636130, 
1055132, 1039340, 
1049619, 810191, 
1052525, 762035, 
1052735, 933502, 
1051759, 11290,
1053555, 605828, 
1054795, 1029900, 
1056690, 565648, 
1057065, 66480, 
1055460, 598577, 
1052080, 241815, 
1052380, 467014, 
1055909, 104841, 
1053805, 134743, 
1058145, 849727, 
1052115, 270177, 
1056801, 529925, 
1049667, 554376, 
1058799, 20782, 
1058650, 929635, 
1051947, 487710, 
1054544, 1038736, 
1050308, 603644, 
1058410, 926763, 
1050604, 256016, 
1050619, 124613, 
1055979, 160489, 
1054007, 63064, 
1051419, 212219, 
1054399, 920337, 
1055295, 817127, 
1050418, 987783, 
1057459, 85599, 
1055855, 74085, 
1053093, 1035944, 
1056811, 553004, 
1056367, 834962, 
1052635, 328340, 
1051999, 125627, 
1055089, 514554, 
1049984, 440195,
1055005, 970792, 
1055478, 169026, 
1055594, 215825, 
1049311, 159095, 
1054770, 1015159, 
1050633, 793603, 
1050252, 218840, 
1052002, 705644, 
1058578, 232738, 
1052944, 476259, 
1052829, 996797, 
1055577, 616857, 
1054073, 156591, 
1049825, 667303, 
1049072, 195361, 
1054657, 87867, 
1053898, 226764, 
1054933, 558023, 
1054132, 706707, 
1055609, 486540, 
1049310, 228387, 
1058353, 233493, 
1051421, 943494, 
1055935, 319647, 
1048881, 265065, 
1056690, 950414, 
1051147, 126912, 
1055444, 705111, 
1050687, 347121, 
1057727, 345660, 
1053241, 875018, 
1053614, 583225, 
1050367, 683465, 
1057081, 895837, 
1058744, 630699, 
1053324, 350846, 
1055818, 224094, 
1048761, 663229, 
1058327, 278846, 
1054603, 1034189, 
1054046, 171038, 
1052672, 842216, 
1056666, 979900, 
1052415, 494287, 
1049144, 650380, 
1057016, 435119, 
1057853, 1027379, 
1052384, 692392, 
1050430, 817695, 
1055289, 440086, 
1054914, 158015,
1049777, 523978, 
1054587, 899617, 
1052398, 718454, 
1058725, 472684, 
1058780, 526903, 
1055759, 165496, 
1053806, 739738, 
1048850, 216974, 
1053372, 718018, 
1051098, 131979, 
1053375, 631200, 
1051816, 819294, 
1053314, 614357, 
1053467, 724971, 
1051687, 452942, 
1051177, 293414, 
1056970, 1036723, 
1051682, 1022813, 
1054808, 771738, 
1053363, 768264, 
1051722, 683663, 
1056990, 91001, 
1055673, 559579, 
1053687, 902636, 
1051134, 222586, 
1052735, 876344, 
1054759, 218795, 
1054572, 504026, 
1049248, 317925, 
1057601, 365669, 
1049491, 983627, 
1051427, 31929, 
1049701, 763239, 
1055742, 398789, 
1049625, 623310, 
1052742, 349744, 
1056364, 916823, 
1050680, 906253, 
1049690, 580986, 
1056542, 46019, 
1050195, 565596, 
1048951, 874784, 
1053798, 600252, 
1051898, 232392, 
1055694, 342738, 
1055009, 68946, 
1048632, 396252, 
1053766, 274040, 
1048892, 276240, 
1053765, 500835, 
1049386, 100524, 
1051924, 66935, 
1049238, 865470, 
1054096, 72556, 
1058629, 315494, 
1057373, 834825, 
1057875, 483755, 
1054725, 964788, 
1053506, 583712, 
1058034, 454971, 
1053772, 422997, 
1058147, 67095, 
1057125, 759164, 
1056186, 763120, 
1052796, 785644, 
1058625, 730736, 
1053378, 276041, 
1056293, 10463, 
1054224, 371108, 
1054281, 949931, 
1052167, 787831, 
1054969, 311626, 
1055102, 195404, 
1049541, 172734, 
1057148, 80338, 
1048947, 463198, 
1053414, 287917, 
1050819, 251332, 
1058490, 155343, 
1055034, 499075, 
1052469, 772304, 
1055068, 414884, 
1058009, 165378, 
1050909, 150088, 
1052269, 958787, 
1054034, 373563, 
1057451, 169030, 
1050018, 924190, 
1058626, 851936, 
1050024, 778205, 
1050969, 521702, 
1053249, 425953, 
1051075, 914358, 
1054540, 191687, 
1055519, 981102, 
1056265, 871359, 
1050585, 727773, 
1055237, 497311, 
1053244, 941216, 
1054701, 1041301, 
1053996, 34276, 
1053315, 874260, 
1049573, 698878, 
1054361, 475176, 
1056444, 608143, 
1049254, 845791, 
1053775, 670724, 
1056039, 837087, 
1054781, 63133, 
1054352, 412770, 
1057100, 445449, 
1050942, 703917, 
1048617, 672539, 
1054439, 938422, 
1053322, 648198, 
1056778, 652270, 
1057448, 929792, 
1056882, 812876, 
1057921, 795097, 
1050776, 122560, 
1058020, 216335, 
1058431, 123236, 
1056516, 891948, 
1055087, 404469, 
1055453, 481289, 
1048767, 78321, 
1052431, 26675, 
1049565, 1018782, 
1055597, 167899, 
1053840, 989661, 
1054124, 250972, 
1056790, 80088, 
1051395, 712909, 
1052769, 89388, 
1050723, 65898, 
1051166, 736880, 
1053266, 2183, 
1049444, 166269, 
1056253, 291024, 
1051290, 334143, 
1056894, 756879, 
1050726, 606094, 
1055380, 546105, 
1058052, 611970, 
1049682, 5240, 
1050895, 373369, 
1057505, 577419, 
1053648, 97588, 
1056967, 28866,
1053294, 626172, 
1054324, 4905, 
1049192, 32596, 
1054776, 399310, 
1051742, 175447, 
1051024, 324599, 
1055814, 286173, 
1058061, 325643, 
1048609, 619064, 
1050663, 570830, 
1055117, 838111, 
1051928, 395083, 
1058791, 797130, 
1054522, 691734, 
1049383, 585056, 
1054436, 901975, 
1054364, 450764, 
1054042, 608865, 
1052369, 814350, 
1050792, 571886, 
1052904, 1043327, 
1054825, 111921, 
1053015, 319066, 
1049420, 402646, 
1054247, 501079, 
1054916, 235923, 
1049516, 339988, 
1053183, 240462, 
1051542, 23064, 
1056844, 16402, 
1052884, 830881, 
1057619, 19766, 
1055575, 956891, 
1053606, 208402, 
1052112, 645577, 
1052928, 554244, 
1050308, 749135, 
1052198, 374389, 
1051326, 804429, 
1051542, 535911, 
1048646, 811721, 
1051642, 384284, 
1051235, 980519, 
1056212, 955166, 
1053375, 584818, 
1057105, 552287, 
1055268, 189767, 
1055820, 645459, 
1055729, 771638, 
1050243, 928499, 
1058572, 501722, 
1057681, 797347, 
1056242, 191912, 
1054909, 22616, 
1056847, 137028, 
1049848, 911656, 
1055994, 844512, 
1052093, 198848, 
1049875, 181488, 
1055768, 716103, 
1057724, 423889, 
1051011, 991659, 
1050357, 504810, 
1049893, 426370,
1052488, 201425, 
1053425, 357290, 
1056418, 467440, 
1056974, 146263, 
1051612, 1039160, 
1054551, 466030, 
1054727, 852073, 
1052252, 866725, 
1057292, 245420, 
1049261, 679734, 
1058569, 273279, 
1051107, 131554, 
1054409, 431482, 
1050699, 71755, 
1050903, 116346, 
1056095, 561330, 
1054857, 224193, 
1050466, 27526, 
1053608, 1053768, 
1054819, 789320, 
1054998, 1041170, 
1051762, 1008465, 
1057793, 499905, 
1055379, 1046788, 
1051507, 904097, 
1058441, 327622, 
1055824, 1008841, 
1049100, 120468, 
1051037, 124311, 
1048735, 738, 
1056053, 321346, 
1051572, 391333, 
1058047, 127562, 
1049401, 754627, 
1054448, 1014965, 
1056786, 341626, 
1054830, 836323, 
1052268, 711776,
1056665, 116192, 
1055462, 767401, 
1052221, 935559, 
1052089, 523, 
1053196, 108061, 
1057262, 392608, 
1055640, 969571, 
1054661, 1058929, 
1049089, 180724, 
1053567, 182975, 
1056321, 109255, 
1055128, 642517, 
1051754, 436604, 
1058332, 271130, 
1058229, 213786, 
1054899, 198951, 
1053109, 936799, 
1054149, 669299, 
1050467, 659773, 
1049052, 697765, 
1057506, 187710, 
1050428, 663400, 
1050054, 929043, 
1057538, 188896, 
1053590, 684309, 
1058109, 937170, 
1054564, 265548, 
1050837, 621395, 
1049614, 516086, 
1056047, 889432, 
1049278, 54777, 
1056955, 783841, 
1048938, 587788, 
1051894, 455241, 
1054893, 826506, 
1054307, 420468, 
1053579, 378663, 
1050887, 699041, 
1051520, 417823, 
1049717, 189187, 
1049636, 57553, 
1048951, 261949, 
1053014, 955923, 
1056726, 1041390, 
1051251, 513156, 
1054248, 153435,
1051161, 542367, 
1048660, 1053140, 
1057853, 808324, 
1050883, 1023986, 
1050200, 985674, 
1057340, 250680, 
1048782, 103374, 
1056430, 434361, 
1050234, 139043 
	Cache: .space 2048
	Holder: .word 0,0,0,0
	
	endln: .asciiz  "\n"
	space: .asciiz  ", "
	hit: .asciiz  "\nHITS: "
.text
main:
     li $t0, 0 #Contador de fin
     li $t1, 0 #contador
FourWay: 
       bgt $t0, 1624, end #Se dirige al branch de end
      
       
       lw $t3, Memoria($t2) #va sacando los valores de la memoria
       div $t3, $t3, 16 #divido por 16 para saber el bloque de memoria
      
       rem $s0, $t3, 128 # busco el remeinder para saber en que set va
	mul $s0, $s0, 16 # multiplico ese valor por 16 para caer en el set
	
	
        lw $s1, Cache($s0) #Guarda Cache[i] en $s0
        addi $s0, $s0, 4 #le suma 4 al contador
        lw $s2, Cache($s0) #Guarda en $s2 Cache[i] en la siguiente posicion
       addi $s0, $s0, 4 # suma 4 al contador
       lw $s3, Cache($s0) # guarda en $s3
       addi $s0, $s0, 4 # suma 4
       lw $s4, Cache($s0) # guarda en $s4
       addi, $s0, $s0, -12 # vuleve a cero el counter
        addi $t0, $t0, 1 # suma uno al contador del loop
         addi $t2, $t2, 4   #mueve al siguiente valor de memoria
        beq $t3, $s1, HIT #Se verifica si se hizo un hit en la primera posicion
        beq $t3, $s2, HIT #Se verifica si se hizo un hit en la segunda posicion
        beq $t3, $s3, HIT # se verifica si hay un hit en la tercera posicion
        beq $t3, $s4, HIT #se verifica si hay un hit en la cuarta posicion
       move $t4, $t0 # mueve el counter al counter de OPTIMO
       move $t5, $t2 # mueve el valor de memoria a OPTIMO
       jal OPTIMO # brinca a OPTIMO
       
        add $s0, $s0, $s7 # suma la posicion del numero que sera movido
        sw $t3, Cache($s0) #si no se hace nigun hit se cambia de posicion ya que hubo un miss
       j FourWay # brinca de nuevo al loop
       
HIT:
       addi $s5, $s5, 1 #Se le suma 1 al contador
       j FourWay # brinca de nuevo al loop
end:
    li $v0, 4
        la $a0, endln		
        syscall
        li $v0, 4
        la $a0, hit #imprime un los hits
        syscall
       
        li $v0, 1
        move $a0, $s5 #imprime el contador de hit
        syscall 

           
       li $v0, 10		# Termina el programa
       syscall
       
  OPTIMO:sw, $ra, ($sp) #guardamos el jump adress
        bgt $t4, 1624, comparador
	lw $t6, Memoria($t5)
	div $t6, $t6, 16
      	beq $t6, $s1, PRE1 #se verifica si el numero aparece
        beq $t6, $s2, PRE2 #se verifica si el numero aparece
        beq $t6, $s3, PRE3 #se verifica si el numero aparece
        beq $t6, $s4, PRE4 #se verifica si el numero aparece
        j UPDATE   
      
 PRE1:	lw $t7, Holder #suma al Holder
 	add  $t7, $t7, 1
 	sw  $t7, Holder
 	j UPDATE
  PRE2:	
  	lw $t7, Holder+4 # suma al Holder
 	add  $t7, $t7, 1
 	sw  $t7, Holder+4

 	j UPDATE
  PRE3:	
  	lw $t7, Holder+8 # suma al Holder
 	add  $t7, $t7, 1
 	sw  $t7, Holder+8
 	j UPDATE
  PRE4:	
  	lw $t7, Holder+12# suma al Holder
 	add  $t7, $t7, 1
 	sw  $t7, Holder+12
 	j UPDATE
 	
 UPDATE: addi $t4, $t4, 1 #update al OPTIMO
	 addi $t5, $t5, 4
	 lw, $s6, Holder
	 j OPTIMO
       
comparador:	
		bgt $t8, 12, reset #cuando corra todo el Holder sal
		lw $t7, Holder($t8) # guarda el adress del holder
		bge   $s6, $t7, IF # verifica si st7 es mas pequeno que $s6
		addi $t8, $t8, 4 # suma cuatro a $t8
		j comparador
	
IF: 	
	move $s6, $t7 # mueve el valor mas pequeno a $s6
	move $s7, $t8 #mueve el adress a $s7
	addi $t8, $t8, 4 # sumale cuatro al adress
	j comparador
	
 reset:  # vuelve todo a su estado original
	sw $zero, Holder 
	sw $zero, Holder+4
	sw $zero, Holder+8
	sw $zero, Holder+12
	li $t1, 0
   	li $t4, 0
   	li $t8, 0
   	li $t5, 0
 	lw $ra, ($sp)
 	jr $ra
       
       
       
       
